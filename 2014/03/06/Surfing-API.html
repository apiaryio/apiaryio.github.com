<!doctype html>
<html prefix="og: http://ogp.me/ns#">
<head>
  <meta charset="utf-8">

  <title>API Design: Mind Maps & Surfing &mdash; Apiary Blog</title>

  <meta name="viewport" content="width=device-width, minimum-scale=1.0">
  <meta name="author" content="Apiary">
  <link rel="alternate" type="application/rss+xml" title="The Apiary Blog Feed" href="https://blog.apiary.io/feed.xml" />

  <meta name="application-name" content="Apiary">
  <meta name="twitter:card" content="summary">
  <meta property="og:type"  content="article">
  <meta name="twitter:site" content="@apiaryio">
  <meta name="twitter:creator" content="@apiaryio">

  <meta name="twitter:title" content="API Design: Mind Maps & Surfing &mdash; Apiary Blog">
  <meta name="twitter:image" content="https://blog.apiary.io/images/apiary-logotype-3D-only.png">

  <meta property="og:title" content="API Design: Mind Maps & Surfing &mdash; Apiary Blog">
  <meta property="og:image" content="https://blog.apiary.io/images/apiary-logotype-3D-only.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  
  
    <meta property="og:url" content="https://blog.apiary.io/2014/03/06/Surfing-API">
    <meta name="description" content="How to design and build API using mind maps, API Blueprint and Apiary. &mdash; Apiary Blog">
    <meta name="twitter:description" content="How to design and build API using mind maps, API Blueprint and Apiary. &mdash; Apiary Blog">
    <meta property="og:description" content="How to design and build API using mind maps, API Blueprint and Apiary. &mdash; Apiary Blog">
  

  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="canonical" href="https://blog.apiary.io/2014/03/06/Surfing-API">

  <!-- Styles -->
  <link rel="stylesheet" href="https://static.apiary.io/assets/styles/fonts.css">
  <link rel="stylesheet" href="https://static.apiary.io/assets/styles/modules/footer/footer.css">
  <link rel="stylesheet" href="https://static.apiary.io/assets/styles/modules/website.css">
  <link rel="stylesheet" href="/syntax.css">
  <!-- /Styles -->

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-18252923-10', 'auto');
  ga('send', 'pageview');
</script>


</head>
<body class="website">

<!-- website-header -->
  <header id="websiteHeader"><div class="positioning">
    <a class="headerLogotypeLink" href="http://apiary.io/"><h1 class="visuallyhidden" title="Apiary Ltd.">Apiary</h1><div class="headerLogotype"></div></a>
    <a class="to_nav" href="#navigation"><span class="visuallyhidden">Go to Navigation</span></a>
  </div></header>
<!-- /website-header -->

<!-- website-navigation -->
  <div id="navigation">
    <nav class="websiteNav positioning">
      <ul class="clearAfter websiteNavMenu">
        
        <li class="websiteNavItem"><a class="websiteNavLink" href="https://apiary.io/how-it-works">How It Works</a></li>
        
        <li class="websiteNavItem"><a class="websiteNavLink" href="https://apiary.io/plans">Plans</a></li>
        
        <li class="websiteNavItem"><a class="websiteNavLink" href="https://apiary.io/products">Product</a></li>
        
        <li class="websiteNavItem"><a class="websiteNavLink" href="https://help.apiary.io/">Help</a></li>
        
        <li class="websiteNavItem"><a class="websiteNavLink" href="https://apiary.io/company">Company</a></li>
        
        <li class="websiteNavItem"><a class="websiteNavLink" href="https://login.apiary.io/login">Sign In</a></li>
        
        <li class="websiteNavItem"><a class="websiteNavLink websiteNavLinkHighlighted signIn" href="https://login.apiary.io/register">Sign Up</a></li>
      </ul>
      <a class="websiteNavLink backToTop" href="javascript:;"><span class="visuallyhidden">Back to top</span></a>
    </nav>
  </div>
<!-- /website-navigation -->

<div>
  <div class="blog">
  
  <div class="blogArticle">
    <a href="/" class="backToArticles">Back to Articles</a>
    <h1>API Design: Mind Maps & Surfing</h1>
    
      <p><span class="minority">By</span> <strong>Z</strong>
        (<a href="https://twitter.com/zdne">zdne</a>, <a href="mailto:z@apiary.io">z@apiary.io</a>) <span class="minority">on</span>&nbsp;06&nbsp;Mar&nbsp;2014
      </p>
    

  <p><img src="/images/2014-03-06-Surfing-API/api-mindmap.png" alt="API mind map" /></p>

<p>When I saw the above API mind map in the excellent article <a href="http://sendgrid.com/blog/quickly-prototype-apis-apiary/"><strong>Quickly Prototype APIs with Apiary</strong></a> by <a href="https://twitter.com/thinkingserious">Elmer Thomas</a> of <a href="http://sendgrid.com">SendGrid</a> I have jumped up.</p>

<p>It never occurred to me before. This is a web structure! This is how Internet works! You go to the root of a site and let the links drive you to whatever the site has to offer. <strong>Surfing the web they say</strong>.</p>

<p>Could this be done with an API? Is it possible explore and consume API resources by something as simple and natural as browsing?</p>

<p>In this article I will demonstrate how to turn a mind map into an API that can be browsed by its clients. To achieve this I will be using API Blueprint and Apiary. The server will be written in Ruby as well as the client surfing the API.</p>

<h2 id="building-the-api-with-apiary">Building the API with Apiary</h2>
<p>Following Elmer’s footsteps I will first describe (a portion of) the GTD Todo API in <a href="https://apiblueprint.org">API Blueprint</a>. Doing so will instantly rewards me with the <em>interactive documentation</em>, <em>mock server</em>, <em>call inspector</em> and most importantly with the <em>tests for a continuous integration</em>.</p>

<h2 id="mind-mapping-the-api">Mind mapping the API</h2>
<p>Mind mapping as the way of thinking about our API is a great idea. Let’s zoom in on the folders portion of GTD Todo API and (mind) map it for the purpose of this article. Note I have put a little bit more emphasis on the distinction between resources attributes (starting with <code class="highlighter-rouge">@</code>) and links:</p>

<p><img src="/images/2014-03-06-Surfing-API/folders-mindmap.png" alt="Folders mind map" /></p>

<h2 id="writing-the-api-blueprint">Writing the API blueprint</h2>
<p>Having an idea what the API should look like I can start writing its API blueprint in Apiary.</p>

<p>One last thing that I need to figure out before writing the blueprint is what media type to use for representing our resources including the links. There is <a href="https://blog.apigee.com/detail/api_design_harnessing_hypermedia_types">plenty</a> to choose from. I will go with <a href="http://stateless.co/hal_specification.html">HAL</a> for the purpose of this article due to its low footprint and lots of great tools supporting it.</p>

<p>The basics of writing a blueprint were already covered in the <a href="http://sendgrid.com/blog/quickly-prototype-apis-apiary/"><em>Quickly Prototype APIs with Apiary</em></a> article so I won’t repeat it here. You can also use the <a href="http://apiary.io/blueprint">API Blueprint tutorial</a> to quickly dive into the API Blueprint format. In case of questions check the API Blueprint at <a href="http://stackoverflow.com/questions/tagged/apiblueprint">Stack Overflow</a> or ask directly the Apiary support.</p>

<p>Here is the completed blueprint and the documentation rendered from it:</p>

<ul>
  <li><a href="https://github.com/zdne/todoapi/blob/master/apiary.apib"><strong>GTD Todo API Blueprint</strong></a></li>
  <li><a href="http://docs.gtdtodoapi.apiary.io"><strong>GTD Todo API Documentation</strong></a></li>
</ul>

<p>With the API blueprint in place we can <strong>immediately start working</strong> on the client <strong>AND</strong> the server since Apiary provides us with the <em>mock server implementation</em> that can be used to build the clients without writing a single line of a server code.</p>

<h2 id="writing-the-server">Writing the server</h2>
<p>As I was implementing the server I was constantly testing it against the blueprint using the <a href="https://github.com/apiaryio/dredd">Dredd</a> API Blueprint testing tool. A <em>description-driven development</em> if you will.</p>

<p>It is a good habit to have the API blueprint living in the repository next to the server implementation. This way it is tested in a continuous integration (e.g. <a href="https://travis-ci.org">Travis CI</a>) every time a change is pushed to the upstream:</p>

<ul>
  <li><a href="https://github.com/zdne/todoapi"><strong>GTD Todo API repository</strong></a></li>
  <li><a href="https://travis-ci.org/zdne/todoapi"><strong>GTD Todo API in Travis CI</strong></a></li>
</ul>

<p>The example server is written in Ruby using <a href="http://www.sinatrarb.com">Sinatra</a> and <a href="https://github.com/apotonick/roar">Roar</a> to better demonstrate another good paradigm: <em>Abstraction of a resource from its representation(s)</em>:</p>

<p>Let’s look at the <code class="highlighter-rouge">Folder</code> resource - a data model as used in backend, perhaps coming from a database:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Folder</span>
  <span class="kp">attr_accessor</span> <span class="ss">:id</span>
  <span class="kp">attr_accessor</span> <span class="ss">:name</span>
  <span class="kp">attr_accessor</span> <span class="ss">:description</span>
  <span class="kp">attr_accessor</span> <span class="ss">:parent</span>
  <span class="kp">attr_accessor</span> <span class="ss">:meta</span>
<span class="k">end</span>
</code></pre>
</div>

<p>In REST we do not send the resources around as they are. Instead we interact with their <em>representations</em>. With <a href="https://github.com/apotonick/roar">Roar</a> I can easily create a resource representation using the appropriate representer, specifying what attributes to represent:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">module</span> <span class="nn">FolderJSONRepresentation</span>
  <span class="kp">include</span> <span class="no">Roar</span><span class="o">::</span><span class="no">Representer</span><span class="o">::</span><span class="no">JSON</span>

  <span class="n">property</span> <span class="ss">:id</span>
  <span class="n">property</span> <span class="ss">:name</span>
  <span class="n">property</span> <span class="ss">:description</span>
  <span class="n">property</span> <span class="ss">:parent</span>
  <span class="n">property</span> <span class="ss">:meta</span>
<span class="k">end</span>
</code></pre>
</div>

<p>and then apply the representer on a resource:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">folder</span> <span class="o">=</span> <span class="no">Folder</span><span class="p">.</span><span class="nf">new</span>
<span class="n">folder</span><span class="p">.</span><span class="nf">extend</span><span class="p">(</span><span class="no">FolderJSONRepresentation</span><span class="p">)</span>
<span class="n">folder</span><span class="p">.</span><span class="nf">to_json</span>  <span class="c1"># returning JSON representation of Folder</span>
</code></pre>
</div>

<p>Similarly I can define and use the HAL or any other (e.g. XML) representation for the <code class="highlighter-rouge">Folder</code> resource. Following this pattern we can keep the backend data models free of any representation clutter and also radically simplify the API content negotiation.</p>

<p>Here is the complete implementation:</p>

<ul>
  <li><a href="https://github.com/zdne/todoapi/blob/master/app.rb"><strong>GTD Todo API server</strong></a></li>
  <li><a href="https://github.com/zdne/todoapi/blob/master/domain_model.rb"><strong>GTD Todo API resources &amp; representations</strong></a></li>
</ul>

<h2 id="writing-the-client">Writing the client</h2>
<p>Time to go surfing.</p>

<p>Having my cake and eat it I will demonstrate using the API on this (slightly contrived) example: Iterate every folder in the API and print all of its attributes.</p>

<p>How hard can this be using Ruby and <a href="https://github.com/gamache/hyperresource">HyperResource</a>?</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">api</span> <span class="o">=</span> <span class="no">HyperResource</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">root: </span><span class="s1">'http://mock-gtdtodoapi.apiary.io'</span><span class="p">)</span>
<span class="n">api</span><span class="p">.</span><span class="nf">folders</span><span class="p">.</span><span class="nf">get</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>

  <span class="n">folder</span> <span class="o">=</span> <span class="no">Folder</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">folder</span><span class="p">.</span><span class="nf">extend</span><span class="p">(</span><span class="no">FolderHALRepresentation</span><span class="p">)</span>
  <span class="n">folder</span><span class="p">.</span><span class="nf">from_hash</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="nf">get</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>

  <span class="nb">puts</span> <span class="s2">"==&gt; folder (</span><span class="si">#{</span><span class="n">f</span><span class="p">.</span><span class="nf">id</span><span class="si">}</span><span class="s2">):"</span>
  <span class="nb">puts</span> <span class="s2">"  name: </span><span class="si">#{</span><span class="n">folder</span><span class="p">.</span><span class="nf">name</span><span class="si">}</span><span class="s2">"</span>
  <span class="nb">puts</span> <span class="s2">"  description: </span><span class="si">#{</span><span class="n">folder</span><span class="p">.</span><span class="nf">description</span><span class="si">}</span><span class="s2">"</span>
  <span class="nb">puts</span> <span class="s2">"  parent: </span><span class="si">#{</span><span class="n">folder</span><span class="p">.</span><span class="nf">parent</span><span class="si">}</span><span class="s2">"</span>
  <span class="nb">puts</span> <span class="s2">"  meta: </span><span class="si">#{</span><span class="n">folder</span><span class="p">.</span><span class="nf">meta</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">"</span>
<span class="k">end</span>
</code></pre>
</div>

<p>What happens here?</p>

<p>First I navigate to the root of GTD Todo API. In this case using the Apiary mock server:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">api</span> <span class="o">=</span> <span class="no">HyperResource</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">root: </span><span class="s1">'http://mock-gtdtodoapi.apiary.io'</span><span class="p">)</span>
</code></pre>
</div>

<p>Then I follow the <code class="highlighter-rouge">folders</code> link retrieving the <code class="highlighter-rouge">folders</code> resource HAL representation and iterate every embedded <code class="highlighter-rouge">folder</code> in it:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">api</span><span class="p">.</span><span class="nf">folders</span><span class="p">.</span><span class="nf">get</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
</code></pre>
</div>

<p>Finally I will create an empty instance of the <code class="highlighter-rouge">Folder</code> resource (sharing the same data model with the server). Extend it with HAL Roar representer and fetch in the folder body following the <code class="highlighter-rouge">self</code> link of the embedded item:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">folder</span> <span class="o">=</span> <span class="no">Folder</span><span class="p">.</span><span class="nf">new</span>
<span class="n">folder</span><span class="p">.</span><span class="nf">extend</span><span class="p">(</span><span class="no">FolderHALRepresentation</span><span class="p">)</span>
<span class="n">folder</span><span class="p">.</span><span class="nf">from_hash</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="nf">get</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>
</div>

<p>Voilà, here is one of the folders ready to print out!</p>

<p>The complete client implementation (not much more to see there):</p>

<ul>
  <li><a href="https://github.com/zdne/todoapi-client-ruby"><strong>GTD Todo API client</strong></a></li>
</ul>

<h2 id="further-reading">Further Reading</h2>
<p>To learn more about the principles of API architecture similar to the architecture of web I would suggest to start with <a href="https://coderwall.com/p/xvzu-g">this summary</a> by Steve Klabnik.</p>

<p>Good read is also the <a href="http://smizell.com/weblog/2013/restful-static-site">Is your API more RESTful than a static HTML site?</a> post by Stephen Mizell.</p>

<h2 id="acknowledgment">Acknowledgment</h2>
<p>The original GTD Todo API mind map and the GTD Todo API idea is courtesy of <a href="https://twitter.com/thinkingserious">Elmer Thomas</a> and it was used with his approval. Thank you Elmer!</p>



  </div>
</div>


</div>

<!-- website-footer -->
  <hr>

<footer class="applicationFooter">

  <div class="applicationFooterRow">
    <div class="applicationFooterColumns">
    <div class="applicationFooterColumn">
    </div><div class="applicationFooterColumn">
      <h3 class="applicationFooterTitle">Platform</h3>
      <ul class="applicationFooterList">
        <li><a class="applicationFooterListLink" href="http://apiary.io/how-it-works">How It Works</a></li>
        <li><a class="applicationFooterListLink" href="http://apiary.io/products">Product</a></li>
        <li><a class="applicationFooterListLink" href="http://enterprise.apiary.io/">Enterprise</a></li>
	<li><a class="applicationFooterListLink" href="http://apiary.io/plans">Plans</a></li>
        <li><a class="applicationFooterListLink" href="https://help.apiary.io">Help</a></li>
      </ul>
    </div><div class="applicationFooterColumn">
      <h3 class="applicationFooterTitle">Company</h3>
      <ul class="applicationFooterList">
        <li><a class="applicationFooterListLink" href="http://blog.apiary.io/">Blog</a></li>
        <li><a class="applicationFooterListLink" href="http://apiary.io/company#team">Team</a></li>
        <li><a class="applicationFooterListLink" href="http://apiary.io/jobs">Jobs</a></li>
        <li><a class="applicationFooterListLink" href="http://apiary.io/company#contact">Contact</a></li>
        <li><a class="applicationFooterListLink" href="https://static.apiary.io/assets/files/apiary-press-kit.zip">Press Kit</a></li>
      </ul>
    </div><div class="applicationFooterColumn">
      <h3 class="applicationFooterTitle">Open Source</h3>
      <ul class="applicationFooterList">
        <li><a class="applicationFooterListLink" href="http://apiblueprint.org">API Blueprint</a></li>
        <li><a class="applicationFooterListLink" href="https://github.com/apiaryio/snowcrash">Snowcrash</a></li>
        <li><a class="applicationFooterListLink" href="https://github.com/apiaryio/gavel">Gavel</a></li>
        <li><a class="applicationFooterListLink" href="https://github.com/apiaryio/dredd">Dredd</a></li>
        <li><a class="applicationFooterListLink" href="http://client.apiary.io">Apiary CLI</a></li>
      </ul>
    </div><div class="applicationFooterColumn">
      <h3 class="applicationFooterTitle">Social</h3>
      <ul class="applicationFooterList">
        <li><a class="applicationFooterListLink" href="https://github.com/apiaryio">GitHub</a></li>
        <li><a class="applicationFooterListLink" href="https://twitter.com/apiaryio">Twitter</a></li>
      </ul>
    </div></div>
  </div>

  <div class="applicationFooterRow">
    <p class="applicationFooterCopyright">Copyright &copy; 2017, Oracle and/or its affiliates. All rights reserved. Oracle and Java are registered trademarks of Oracle and/or its affiliates. Other names may be trademarks of their respective owners. <span class="applicationFooterCopyrightLinks">• <a href="http://apiary.io/tos" class="applicationFooterCopyrightLink">Terms</a> • <a href="https://apiary.io/privacy" class="applicationFooterCopyrightLink">Privacy</a></span></p>
  </div>
</footer>
<!-- /website-footer -->

<script src="https://static.apiary.io/assets/js/website-scroll.js"></script>
<script>
  websiteScroll();
  document.documentElement.className += ' js';
</script>

</body>
</html>
